# Workflow for experiment 3

#First the table
df %>% select(PERCENT_WHITE, PERCENT_BLACK, PERCENT_HISPANIC, PERCENT_ASIAN, AVGSAT, GRADINCOME) %>% filter (PERCENT_WHITE != "null", AVGSAT != "null", GRADINCOME != "null")      %>% mutate (majority_percent = pmax(as.numeric(as.character(PERCENT_WHITE)), as.numeric(as.character(PERCENT_BLACK)), as.numeric(as.character(PERCENT_HISPANIC)), as.numeric(as.character(PERCENT_ASIAN))))                                         %>% mutate(majority = ifelse(as.numeric(as.character(PERCENT_WHITE)) == majority_percent, "White", ifelse(as.numeric(as.character(PERCENT_BLACK)) == majority_percent, "Black", ifelse(as.numeric(as.character(PERCENT_ASIAN)) == majority_percent, "Asian", ifelse(as.numeric(as.character(PERCENT_HISPANIC)) == majority_percent, "Hispanic", "Other")))))         %>% tbl_df

# Second the visualization
df %>% select(PERCENT_WHITE, PERCENT_BLACK, PERCENT_HISPANIC, PERCENT_ASIAN, AVGSAT, GRADINCOME) %>% filter (PERCENT_WHITE != "null", AVGSAT != "null", GRADINCOME != "null")      %>% mutate (majority_percent = pmax(as.numeric(as.character(PERCENT_WHITE)), as.numeric(as.character(PERCENT_BLACK)), as.numeric(as.character(PERCENT_HISPANIC)), as.numeric(as.character(PERCENT_ASIAN))))                                         %>% mutate(majority = ifelse(as.numeric(as.character(PERCENT_WHITE)) == majority_percent, "White", ifelse(as.numeric(as.character(PERCENT_BLACK)) == majority_percent, "Black", ifelse(as.numeric(as.character(PERCENT_ASIAN)) == majority_percent, "Asian", ifelse(as.numeric(as.character(PERCENT_HISPANIC)) == majority_percent, "Hispanic", "Other")))))         %>% ggplot(aes(x = as.numeric(as.character(GRADINCOME)),y = as.numeric(as.character(AVGSAT)), color = majority)) + labs(title = "Income/SAT Distribution by Racial Majority", x = "Average Income Upon Graduation", y = "Average SAT") + geom_jitter()

